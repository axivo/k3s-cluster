defaultSettings:
  allowCollectingLonghornUsageMetrics: {{ longhorn_vars.kubernetes.default_settings.usage_metrics }}
{% if longhorn_vars.kubernetes.default_settings.backup.enabled %}
  backupTarget: {{ longhorn_vars.kubernetes.default_settings.backup.target }}
{% if longhorn_vars.kubernetes.default_settings.backup.target[:3] | lower != 'nfs' %}
  backupTargetCredentialSecret: {{ longhorn_vars.kubernetes.default_settings.backup.secret.name }}
{% endif %}
{% endif %}
  defaultDataLocality: {{ longhorn_vars.kubernetes.default_settings.data_locality }}
  defaultReplicaCount: {{ longhorn_vars.kubernetes.default_settings.replicas }}
  nodeDownPodDeletionPolicy: {{ longhorn_vars.kubernetes.default_settings.pod_deletion_policy }}
  orphanAutoDeletion: {{ longhorn_vars.kubernetes.default_settings.orphan_auto_deletion }}
  replicaAutoBalance: {{ longhorn_vars.kubernetes.default_settings.replica_auto_balance }}
  rwxVolumeFastFailover: {{ longhorn_vars.kubernetes.default_settings.rwx_volume_fast_failover }}
{% if longhorn_vars.kubernetes.default_settings.data_engine | lower == 'v1' %}
  v1DataEngine: true
{% endif %}
{% if k3s_vars.server.controlplane.tainted %}
{% if k3s_node_default_taint | length > 0 %}
  taintToleration: {{ k3s_node_default_taint | join | trim }}
{% endif %}
longhornDriver:
  tolerations:
    {{ k3s_vars.tolerations | to_nice_yaml | indent(4) }}
longhornManager:
  tolerations:
    {{ k3s_vars.tolerations | to_nice_yaml | indent(4) }}
{% endif %}
persistence:
  defaultDataLocality: {{ longhorn_vars.kubernetes.persistence.data_locality }}
  defaultFsType: {{ longhorn_vars.kubernetes.persistence.fs_type }}
  disableRevisionCounter: {{ longhorn_vars.kubernetes.persistence.disable_revision_counter }}
  migratable: {{ longhorn_vars.kubernetes.persistence.migratable }}
  nfsOptions: {{ longhorn_vars.kubernetes.persistence.nfs_options }}
  removeSnapshotsDuringFilesystemTrim: {{ longhorn_vars.kubernetes.persistence.remove_snapshots_during_filesystem_trim }}
